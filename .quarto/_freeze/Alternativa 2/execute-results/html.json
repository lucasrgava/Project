{
  "hash": "0e702b88720006ea127c828cd919b13f",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Abordagem como Fatorial duplo com tratamento adicional em DBC\"\nauthor: \"Lucas R. Gava, Iago Vieira\"\nformat: html\neditor: visual\n---\n\n\n# Pacotes\n\nPacotes utilizados no decorrer do código.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(gsheet)\nlibrary(epifitter)\nlibrary(lme4)\nlibrary(ExpDes.pt)\nlibrary(agricolae)\nlibrary(AgroR)\nlibrary(performance)\n```\n:::\n\n\n# Importando os bancos de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dados de produtividade\ndados <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1KPWFOqs_Cclj3VgiHPxP3zazOmucRVAc/edit?gid=836516162#gid=836516162')\n\n# Dados de severidade\ndados2 <- gsheet2tbl('https://docs.google.com/spreadsheets/d/1KPWFOqs_Cclj3VgiHPxP3zazOmucRVAc/edit?gid=1484935950#gid=1484935950')\n```\n:::\n\n\n# Variáveis respostas\n\n## AACPD\n\n### Ajuste dos dados\n\nComo na parcela foi avaliada 3 folhas por planta de 3 plantas, tem-se 9 valores por observação. Nesse caso, antes de prosseguir, vamos resumir esses valores em um único valor de severidade média. Dessa forma, reduzindo nosso banco de dados de 336 linhas para 112. Isso representa, 7 tratamentos, 4 blocos e 4 momentos de avaliação.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados2 <- dados2 |> \n  mutate(sev.med = rowMeans(across(starts_with('sev_f')))) |> \n  dplyr::select(- c(9, 10, 11)) |> \n  group_by(treat, block, assessment) |> \n  summarise(sev.med = mean(sev.med))\n  \nknitr::kable(dados2)\n```\n\n::: {.cell-output-display}\n\n\n|treat               | block| assessment|    sev.med|\n|:-------------------|-----:|----------:|----------:|\n|FOX V6/V8           |     1|          1|  0.0444444|\n|FOX V6/V8           |     1|          2|  0.1666667|\n|FOX V6/V8           |     1|          3|  1.8444444|\n|FOX V6/V8           |     1|          4|  7.2444444|\n|FOX V6/V8           |     2|          1|  0.0222222|\n|FOX V6/V8           |     2|          2|  0.1111111|\n|FOX V6/V8           |     2|          3|  2.1333333|\n|FOX V6/V8           |     2|          4|  1.7000000|\n|FOX V6/V8           |     3|          1|  0.0555556|\n|FOX V6/V8           |     3|          2|  0.0555556|\n|FOX V6/V8           |     3|          3|  0.6666667|\n|FOX V6/V8           |     3|          4|  3.6888889|\n|FOX V6/V8           |     4|          1|  0.2777778|\n|FOX V6/V8           |     4|          2|  0.1333333|\n|FOX V6/V8           |     4|          3|  0.4333333|\n|FOX V6/V8           |     4|          4|  4.2222222|\n|FOX V6/V8+VT        |     1|          1|  0.1666667|\n|FOX V6/V8+VT        |     1|          2|  0.0111111|\n|FOX V6/V8+VT        |     1|          3|  0.6555556|\n|FOX V6/V8+VT        |     1|          4|  2.1666667|\n|FOX V6/V8+VT        |     2|          1|  0.0333333|\n|FOX V6/V8+VT        |     2|          2|  0.1222222|\n|FOX V6/V8+VT        |     2|          3|  0.4111111|\n|FOX V6/V8+VT        |     2|          4|  3.3666667|\n|FOX V6/V8+VT        |     3|          1|  0.0000000|\n|FOX V6/V8+VT        |     3|          2|  0.0222222|\n|FOX V6/V8+VT        |     3|          3|  0.3888889|\n|FOX V6/V8+VT        |     3|          4|  4.8111111|\n|FOX V6/V8+VT        |     4|          1|  0.0222222|\n|FOX V6/V8+VT        |     4|          2|  0.0777778|\n|FOX V6/V8+VT        |     4|          3|  0.4000000|\n|FOX V6/V8+VT        |     4|          4|  5.6666667|\n|FOX VT              |     1|          1|  0.0777778|\n|FOX VT              |     1|          2|  0.0000000|\n|FOX VT              |     1|          3|  0.6555556|\n|FOX VT              |     1|          4|  5.3333333|\n|FOX VT              |     2|          1|  0.0000000|\n|FOX VT              |     2|          2|  0.2000000|\n|FOX VT              |     2|          3|  1.4888889|\n|FOX VT              |     2|          4|  3.0222222|\n|FOX VT              |     3|          1|  0.0000000|\n|FOX VT              |     3|          2|  0.7000000|\n|FOX VT              |     3|          3|  1.4222222|\n|FOX VT              |     3|          4| 11.0000000|\n|FOX VT              |     4|          1|  0.0000000|\n|FOX VT              |     4|          2|  0.1111111|\n|FOX VT              |     4|          3|  0.9555556|\n|FOX VT              |     4|          4| 12.0000000|\n|PRIORIXTRA V6/V8    |     1|          1|  0.0000000|\n|PRIORIXTRA V6/V8    |     1|          2|  0.0111111|\n|PRIORIXTRA V6/V8    |     1|          3|  0.5333333|\n|PRIORIXTRA V6/V8    |     1|          4|  6.0000000|\n|PRIORIXTRA V6/V8    |     2|          1|  0.0000000|\n|PRIORIXTRA V6/V8    |     2|          2|  0.1333333|\n|PRIORIXTRA V6/V8    |     2|          3|  0.7555556|\n|PRIORIXTRA V6/V8    |     2|          4|  3.8888889|\n|PRIORIXTRA V6/V8    |     3|          1|  0.0111111|\n|PRIORIXTRA V6/V8    |     3|          2|  0.1000000|\n|PRIORIXTRA V6/V8    |     3|          3|  0.5888889|\n|PRIORIXTRA V6/V8    |     3|          4|  6.2222222|\n|PRIORIXTRA V6/V8    |     4|          1|  0.1666667|\n|PRIORIXTRA V6/V8    |     4|          2|  0.0000000|\n|PRIORIXTRA V6/V8    |     4|          3|  0.2333333|\n|PRIORIXTRA V6/V8    |     4|          4|  5.3555556|\n|PRIORIXTRA V6/V8+VT |     1|          1|  0.0888889|\n|PRIORIXTRA V6/V8+VT |     1|          2|  0.0000000|\n|PRIORIXTRA V6/V8+VT |     1|          3|  0.4111111|\n|PRIORIXTRA V6/V8+VT |     1|          4|  0.3555556|\n|PRIORIXTRA V6/V8+VT |     2|          1|  0.0000000|\n|PRIORIXTRA V6/V8+VT |     2|          2|  0.0444444|\n|PRIORIXTRA V6/V8+VT |     2|          3|  0.0555556|\n|PRIORIXTRA V6/V8+VT |     2|          4|  0.1222222|\n|PRIORIXTRA V6/V8+VT |     3|          1|  0.0000000|\n|PRIORIXTRA V6/V8+VT |     3|          2|  0.0666667|\n|PRIORIXTRA V6/V8+VT |     3|          3|  0.3111111|\n|PRIORIXTRA V6/V8+VT |     3|          4|  3.8888889|\n|PRIORIXTRA V6/V8+VT |     4|          1|  0.0000000|\n|PRIORIXTRA V6/V8+VT |     4|          2|  0.0000000|\n|PRIORIXTRA V6/V8+VT |     4|          3|  0.1777778|\n|PRIORIXTRA V6/V8+VT |     4|          4|  4.1222222|\n|PRIORIXTRA VT       |     1|          1|  0.2000000|\n|PRIORIXTRA VT       |     1|          2|  0.1222222|\n|PRIORIXTRA VT       |     1|          3|  1.3000000|\n|PRIORIXTRA VT       |     1|          4|  5.0333333|\n|PRIORIXTRA VT       |     2|          1|  0.0000000|\n|PRIORIXTRA VT       |     2|          2|  0.0777778|\n|PRIORIXTRA VT       |     2|          3|  0.3666667|\n|PRIORIXTRA VT       |     2|          4|  7.6111111|\n|PRIORIXTRA VT       |     3|          1|  0.0111111|\n|PRIORIXTRA VT       |     3|          2|  0.4000000|\n|PRIORIXTRA VT       |     3|          3|  0.1555556|\n|PRIORIXTRA VT       |     3|          4|  6.3444444|\n|PRIORIXTRA VT       |     4|          1|  0.0888889|\n|PRIORIXTRA VT       |     4|          2|  0.5222222|\n|PRIORIXTRA VT       |     4|          3|  0.3888889|\n|PRIORIXTRA VT       |     4|          4|  8.4444444|\n|TESTEMUNHA          |     1|          1|  0.4333333|\n|TESTEMUNHA          |     1|          2|  0.0444444|\n|TESTEMUNHA          |     1|          3|  0.6777778|\n|TESTEMUNHA          |     1|          4| 10.3888889|\n|TESTEMUNHA          |     2|          1|  0.0333333|\n|TESTEMUNHA          |     2|          2|  0.1222222|\n|TESTEMUNHA          |     2|          3|  2.1222222|\n|TESTEMUNHA          |     2|          4|  5.7222222|\n|TESTEMUNHA          |     3|          1|  0.1666667|\n|TESTEMUNHA          |     3|          2|  0.4333333|\n|TESTEMUNHA          |     3|          3|  1.1444444|\n|TESTEMUNHA          |     3|          4| 10.6666667|\n|TESTEMUNHA          |     4|          1|  0.0111111|\n|TESTEMUNHA          |     4|          2|  0.2555556|\n|TESTEMUNHA          |     4|          3|  1.7888889|\n|TESTEMUNHA          |     4|          4|  9.3666667|\n\n\n:::\n:::\n\n\nComo nosso banco de dados (**dados2**), contêm os valores médios de severidade de cada tratamento, cada bloco e cada tempo de avaliação, é possível, utilizando a função `AUDPC()` do pacote **EPIFITTER**, calcular a área abaixo da curva de progresso da doença (AACPD).\n\n\n::: {.cell}\n\n```{.r .cell-code}\naacpd1 <- dados2 |> \n  group_by(treat, block) |> \n  summarise(aacpd = AUDPC(assessment, sev.med))\n\naacpd <- aacpd1 |> \n  separate(col = treat, into = c('Fator1', 'Fator2'), sep = ' ')\n\naacpd2 <- aacpd |> \n mutate(Fator2= ifelse(Fator1 == 'TESTEMUNHA', 0, Fator2))\n\n\nknitr::kable(aacpd2)\n```\n\n::: {.cell-output-display}\n\n\n|Fator1     |Fator2   | block|     aacpd|\n|:----------|:--------|-----:|---------:|\n|FOX        |V6/V8    |     1| 5.6555556|\n|FOX        |V6/V8    |     2| 3.1055556|\n|FOX        |V6/V8    |     3| 2.5944444|\n|FOX        |V6/V8    |     4| 2.8166667|\n|FOX        |V6/V8+VT |     1| 1.8333333|\n|FOX        |V6/V8+VT |     2| 2.2333333|\n|FOX        |V6/V8+VT |     3| 2.8166667|\n|FOX        |V6/V8+VT |     4| 3.3222222|\n|FOX        |VT       |     1| 3.3611111|\n|FOX        |VT       |     2| 3.2000000|\n|FOX        |VT       |     3| 7.6222222|\n|FOX        |VT       |     4| 7.0666667|\n|PRIORIXTRA |V6/V8    |     1| 3.5444444|\n|PRIORIXTRA |V6/V8    |     2| 2.8333333|\n|PRIORIXTRA |V6/V8    |     3| 3.8055556|\n|PRIORIXTRA |V6/V8    |     4| 2.9944444|\n|PRIORIXTRA |V6/V8+VT |     1| 0.6333333|\n|PRIORIXTRA |V6/V8+VT |     2| 0.1611111|\n|PRIORIXTRA |V6/V8+VT |     3| 2.3222222|\n|PRIORIXTRA |V6/V8+VT |     4| 2.2388889|\n|PRIORIXTRA |VT       |     1| 4.0388889|\n|PRIORIXTRA |VT       |     2| 4.2500000|\n|PRIORIXTRA |VT       |     3| 3.7333333|\n|PRIORIXTRA |VT       |     4| 5.1777778|\n|TESTEMUNHA |0        |     1| 6.1333333|\n|TESTEMUNHA |0        |     2| 5.1222222|\n|TESTEMUNHA |0        |     3| 6.9944444|\n|TESTEMUNHA |0        |     4| 6.7333333|\n\n\n:::\n:::\n\n\n### Premissas\n\nP-valores \\> 0,05! Sinal verde para prosseguir com a análise paramétrica.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(aacpd ~ Fator1*Fator2 + block, data = aacpd2)\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.335).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.336).\n```\n\n\n:::\n:::\n\n\n### Anova e teste de Tukey\n\nA função que iremos utilizar a seguir se chama `fat2.ad.dbc()`, do pacote **ExpDes.pt**. Essa função é dedicada a análise de dados onde o delinemaento adotado foi em blocos ao acaso em esquema fatorial 3x2 + 1. Para saber mais sobre a função e o sobre o pacote, execute no console os comandos: `?fat2.ad.dbc`, para ajuda da função e `??ExpDes.pt`, para informações sobre o pacote.\n\nAntes de executar a função, devemos organizar os dados separando em dois dataframes: os dados referentes ao fatorial e os dados referente ao tratamento adicional. Em seguida, podemos preencher os argumentos da função como no código.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Estruturando banco de dados\naacpd <- aacpd |> \n  mutate(treat.ad = ifelse(Fator1 == 'TESTEMUNHA', Fator1, NA)) |> \n  mutate(Fator1 = ifelse(Fator1 == 'TESTEMUNHA', NA, Fator1))\n  \nfatorial <- aacpd |> \n  filter(!is.na(Fator1))\n\ntreat.ad <- aacpd |> \n  filter(treat.ad == 'TESTEMUNHA')\n\n# Rodando od testes\n\nfat2.ad.dbc(fator1 = fatorial$Fator1, fator2 = fatorial$Fator2, bloco = fatorial$block, resp = fatorial$aacpd, respAd = treat.ad$aacpd, fac.names = c('Fungicidas', 'Estádios'))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  Fungicidas \nFATOR 2:  Estádios \n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                    GL       SQ       QM      Fc  Pr>Fc\nBloco                3  8.46646  2.82215  2.1988 0.1234\nFungicidas           1  4.07917  4.07917  3.1782 0.0915\nEstádios             2 32.75371 16.37686 12.7597  4e-04\nFungicidas*Estádios  2  1.03507  0.51754  0.4032  0.674\nAd vs Fatorial       1 27.96178 27.96178 21.7858  2e-04\nResiduo             18 23.10271  1.28348               \nTotal               27 97.39890                        \n------------------------------------------------------------------------\nCV = 29.83 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.3965633 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\nContraste do tratamento adicional com o fatorial\n------------------------------------------------------------------------\n            Medias  \nAdicional 6.245833 a\nFatorial  3.390046 b\n------------------------------------------------------------------------\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nFungicidas\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n      Niveis   Medias\n1        FOX 3.802315\n2 PRIORIXTRA 2.977778\n------------------------------------------------------------------------\nEstádios\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na \t VT \t 4.80625 \na \t V6/V8 \t 3.41875 \n b \t V6/V8+VT \t 1.945139 \n------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\nComo resultado da ANOVA, identificamos que existe diferença significativa entre os níveis do fator Estádio de aplicação e tratamento adicional versus fatorial. Não houve diferença significativa entre os níveis do fator Fungicidas.\n\nO teste de Tukey, aplicado sobre os níveis do fator estádio, indicou que realizando a aplicação dos fungicidas nos estádio V6/V8 e em VT é melhor do aplicar em V6/V8 ou em VT.\n\nO teste anterior mostrou que existe diferença entre o fatorial versus o tratamento adicional. No entanto, ele não discriminou o tratamento adicional versus a combinação dos níveis dos dois fatores. Dessa forma, adotamos o teste de Dunnett para conseguir identificar quais foram os tratamentos estatisticamente diferentes da testemunha.\n\n### Teste de Dunnett\n\nO teste de Dunnet é um teste adotado quando se deseja comparar as médias dos tratamentos contra a média de um tratamento de interesse. No nosso caso, confrontamos contra o tratamento testemunha.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndunnett(trat = aacpd1$treat, resp = aacpd1$aacpd, control = 'TESTEMUNHA', model = 'DBC', block = aacpd1$block)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                     Estimate    IC-lwr     IC-upr t value\nTESTEMUNHA  -  FOX V6/V8           -2.7027778 -4.969283 -0.4362729 -3.3739\nTESTEMUNHA  -  FOX V6/V8+VT        -3.6944444 -5.960949 -1.4279395 -4.6118\nTESTEMUNHA  -  FOX VT              -0.9333333 -3.199838  1.3331716 -1.1651\nTESTEMUNHA  -  PRIORIXTRA V6/V8    -2.9513889 -5.217894 -0.6848840 -3.6842\nTESTEMUNHA  -  PRIORIXTRA V6/V8+VT -4.9069444 -7.173449 -2.6404395 -6.1254\nTESTEMUNHA  -  PRIORIXTRA VT       -1.9458333 -4.212338  0.3206716 -2.4290\n                                   p-value sig\nTESTEMUNHA  -  FOX V6/V8            0.0165   *\nTESTEMUNHA  -  FOX V6/V8+VT         0.0010   *\nTESTEMUNHA  -  FOX VT               0.7138  ns\nTESTEMUNHA  -  PRIORIXTRA V6/V8     0.0084   *\nTESTEMUNHA  -  PRIORIXTRA V6/V8+VT  0.0000   *\nTESTEMUNHA  -  PRIORIXTRA VT        0.1088  ns\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Alternativa-2_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nPercebemos que exceto os tratamentos PRIORI XTRA VT e FOX VT, todos os tratamentos foram significativos contra a testemunha sem aplicação.\n\n## Y máx\n\nA partir de agora, o processo é semelhante para as demais variáveis.\n\n### Ajuste dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny.max1 <- dados2 |> \n  filter(assessment == 4)\ny.max1$sev.med <- round(y.max1$sev.med, 2)\n\ny.max <- y.max1 |> \n  separate(col = treat, into = c('Fator1', 'Fator2'), sep = ' ')\ny.max <- y.max |> \n  mutate(treat.ad = ifelse(Fator1 == 'TESTEMUNHA', Fator1, NA))\n\ny.max <- y.max |> \n  mutate(Fator1 = ifelse(Fator1 == 'TESTEMUNHA', NA, Fator1))\n```\n:::\n\n\n### Premissas\n\nPremissas atendidas!\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny.max.pre <- y.max |> \n  dplyr::select(-treat.ad, -assessment) |> \n  mutate(Fator1 = ifelse(is.na(Fator1), 'TESTEMUNHA', Fator1)) |> \n  mutate(Fator2 = ifelse(is.na(Fator2), 0, Fator2))\n\nknitr::kable(y.max.pre)\n```\n\n::: {.cell-output-display}\n\n\n|Fator1     |Fator2   | block| sev.med|\n|:----------|:--------|-----:|-------:|\n|FOX        |V6/V8    |     1|    7.24|\n|FOX        |V6/V8    |     2|    1.70|\n|FOX        |V6/V8    |     3|    3.69|\n|FOX        |V6/V8    |     4|    4.22|\n|FOX        |V6/V8+VT |     1|    2.17|\n|FOX        |V6/V8+VT |     2|    3.37|\n|FOX        |V6/V8+VT |     3|    4.81|\n|FOX        |V6/V8+VT |     4|    5.67|\n|FOX        |VT       |     1|    5.33|\n|FOX        |VT       |     2|    3.02|\n|FOX        |VT       |     3|   11.00|\n|FOX        |VT       |     4|   12.00|\n|PRIORIXTRA |V6/V8    |     1|    6.00|\n|PRIORIXTRA |V6/V8    |     2|    3.89|\n|PRIORIXTRA |V6/V8    |     3|    6.22|\n|PRIORIXTRA |V6/V8    |     4|    5.36|\n|PRIORIXTRA |V6/V8+VT |     1|    0.36|\n|PRIORIXTRA |V6/V8+VT |     2|    0.12|\n|PRIORIXTRA |V6/V8+VT |     3|    3.89|\n|PRIORIXTRA |V6/V8+VT |     4|    4.12|\n|PRIORIXTRA |VT       |     1|    5.03|\n|PRIORIXTRA |VT       |     2|    7.61|\n|PRIORIXTRA |VT       |     3|    6.34|\n|PRIORIXTRA |VT       |     4|    8.44|\n|TESTEMUNHA |0        |     1|   10.39|\n|TESTEMUNHA |0        |     2|    5.72|\n|TESTEMUNHA |0        |     3|   10.67|\n|TESTEMUNHA |0        |     4|    9.37|\n\n\n:::\n\n```{.r .cell-code}\nm2 <- lm(sev.med ~ Fator1*Fator2 + block, y.max.pre)\n\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.788).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.377).\n```\n\n\n:::\n:::\n\n\n### Anova e teste de Tukey\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfator.y <- y.max |> \n  filter(!-is.na(Fator1))\n  \ntreat.ad.y <- y.max |> \n  filter(!-is.na(treat.ad))\n\nfat2.ad.dbc(fator1 = fator.y$Fator1, fator2 = fator.y$Fator2, bloco = fator.y$block, resp = fator.y$sev.med, respAd = treat.ad.y$sev.med, fac.names = c('Fungicidas', 'Estádios'))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  Fungicidas \nFATOR 2:  Estádios \n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                    GL        SQ       QM      Fc  Pr>Fc\nBloco                3  50.17521 16.72507  4.3367 0.0182\nFungicidas           1   1.94940   1.9494  0.5055 0.4862\nEstádios             2  74.27776 37.13888  9.6298 0.0014\nFungicidas*Estádios  2   9.73687  4.86844  1.2623 0.3069\nAd vs Fatorial       1  54.06006 54.06006 14.0173 0.0015\nResiduo             18  69.41976  3.85665               \nTotal               27 259.61907                        \n------------------------------------------------------------------------\nCV = 34.86 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.2531165 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\nContraste do tratamento adicional com o fatorial\n------------------------------------------------------------------------\n            Medias  \nAdicional 9.037500 a\nFatorial  5.066667 b\n------------------------------------------------------------------------\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nFungicidas\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n      Niveis   Medias\n1        FOX 5.351667\n2 PRIORIXTRA 4.781667\n------------------------------------------------------------------------\nEstádios\nTeste de Tukey\n------------------------------------------------------------------------\nGrupos Tratamentos Medias\na \t VT \t 7.34625 \n b \t V6/V8 \t 4.79 \n b \t V6/V8+VT \t 3.06375 \n------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\nComo resultado da ANOVA, identificamos diferença significativa também entre os níveis do fator Estádio e do tratamento adicional versus o fatorial. Não houve diferença significativa entre os níveis do fator Fungicida sobre a variável de intensidade máxima (Ymax).\n\nO teste de Tukey indicou que entre os níveis do fator Estádio, as aplicaçãoes em V6/V8 e em V6/V8 + VT é melhor do que fazer uma única aplicação em VT.\n\n### Teste de Dunnett\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndunnett(trat = y.max1$treat, resp = y.max1$sev.med, control = 'TESTEMUNHA', model = 'DBC', block = y.max1$block)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                   Estimate     IC-lwr     IC-upr t value\nTESTEMUNHA  -  FOX V6/V8            -4.8250  -8.752714 -0.8972856 -3.4746\nTESTEMUNHA  -  FOX V6/V8+VT         -5.0325  -8.960214 -1.1047856 -3.6240\nTESTEMUNHA  -  FOX VT               -1.2000  -5.127714  2.7277144 -0.8642\nTESTEMUNHA  -  PRIORIXTRA V6/V8     -3.6700  -7.597714  0.2577144 -2.6429\nTESTEMUNHA  -  PRIORIXTRA V6/V8+VT  -6.9150 -10.842714 -2.9872856 -4.9797\nTESTEMUNHA  -  PRIORIXTRA VT        -2.1825  -6.110214  1.7452144 -1.5717\n                                   p-value sig\nTESTEMUNHA  -  FOX V6/V8            0.0132   *\nTESTEMUNHA  -  FOX V6/V8+VT         0.0095   *\nTESTEMUNHA  -  FOX VT               0.8905  ns\nTESTEMUNHA  -  PRIORIXTRA V6/V8     0.0725  ns\nTESTEMUNHA  -  PRIORIXTRA V6/V8+VT  0.0005   *\nTESTEMUNHA  -  PRIORIXTRA VT        0.4458  ns\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Alternativa-2_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nComo resultado do teste de Dunnett, os tratamentos PRIORI XTRA V6/V8+VT, FOX V6/V8+VT e FOX V6/V8 apresentaram diferença significativa da testemunha.\n\n## PRODUTIVIDADE\n\n### Ajuste dos dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprodutividade <- dados |> \n  dplyr::select(Fator1, Fator2, treat.ad, block, productivity)\n\ntrat.ad <- produtividade |> \n  filter(treat.ad == 'TESTEMUNHA') |> \n  dplyr::select(productivity)\n\nfatorial <- produtividade |> \n  filter(!is.na(Fator1))\n```\n:::\n\n\n### Premissas\n\nPremissas atendidas!\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprod.pre <- produtividade |> \n  dplyr::select(-treat.ad) |> \n  mutate(Fator1 = ifelse(is.na(Fator1), 'TESTEMUNHA', Fator1)) |> \n  mutate(Fator2 = ifelse(is.na(Fator2), 0, Fator2))\n\nknitr::kable(prod.pre)\n```\n\n::: {.cell-output-display}\n\n\n|Fator1      |Fator2     | block| productivity|\n|:-----------|:----------|-----:|------------:|\n|FOX         |V6/V8      |     1|     41.07406|\n|FOX         |V6/V8      |     2|     47.99257|\n|FOX         |V6/V8      |     3|     47.44443|\n|FOX         |V6/V8      |     4|     40.58332|\n|FOX         |V6/V8 + VT |     1|     39.81480|\n|FOX         |V6/V8 + VT |     2|     55.68516|\n|FOX         |V6/V8 + VT |     3|     39.81480|\n|FOX         |V6/V8 + VT |     4|     50.33331|\n|FOX         |VT         |     1|     49.21294|\n|FOX         |VT         |     2|     48.72220|\n|FOX         |VT         |     3|     41.58332|\n|FOX         |VT         |     4|     44.95369|\n|PRIORI XTRA |V6/V8      |     1|     39.24998|\n|PRIORI XTRA |V6/V8      |     2|     54.76850|\n|PRIORI XTRA |V6/V8      |     3|     43.36109|\n|PRIORI XTRA |V6/V8      |     4|     45.90739|\n|PRIORI XTRA |V6/V8 + VT |     1|     48.65739|\n|PRIORI XTRA |V6/V8 + VT |     2|     42.12961|\n|PRIORI XTRA |V6/V8 + VT |     3|     44.20369|\n|PRIORI XTRA |V6/V8 + VT |     4|     49.85183|\n|PRIORI XTRA |VT         |     1|     44.92591|\n|PRIORI XTRA |VT         |     2|     40.21295|\n|PRIORI XTRA |VT         |     3|     45.61109|\n|PRIORI XTRA |VT         |     4|     49.92591|\n|TESTEMUNHA  |0          |     1|     41.94443|\n|TESTEMUNHA  |0          |     2|     47.24998|\n|TESTEMUNHA  |0          |     3|     46.60183|\n|TESTEMUNHA  |0          |     4|     44.10183|\n\n\n:::\n\n```{.r .cell-code}\nm3 <- lm(productivity ~ Fator1*Fator2 + block, prod.pre)\n\ncheck_normality(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.197).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_heteroscedasticity(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.516).\n```\n\n\n:::\n:::\n\n\n### Anova e teste de Tukey\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfat2.ad.dbc(fator1 = fatorial$Fator1, fator2 = fatorial$Fator2, bloco = fatorial$block, resp = fatorial$productivity, respAd = trat.ad$productivity, fac.names = c('Fungicidas', 'Estádios'))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n------------------------------------------------------------------------\nLegenda:\nFATOR 1:  Fungicidas \nFATOR 2:  Estádios \n------------------------------------------------------------------------\n\n------------------------------------------------------------------------\nQuadro da analise de variancia\n------------------------------------------------------------------------\n                    GL        SQ       QM     Fc  Pr>Fc\nBloco                3  95.27103 31.75701 1.3821 0.2803\nFungicidas           1   0.10544  0.10544 0.0046 0.9467\nEstádios             2   6.39422  3.19711 0.1391  0.871\nFungicidas*Estádios  2   6.57066  3.28533  0.143 0.8677\nAd vs Fatorial       1   1.64647  1.64647 0.0717  0.792\nResiduo             18 413.59904 22.97772              \nTotal               27 523.58686                       \n------------------------------------------------------------------------\nCV = 10.52 %\n\n------------------------------------------------------------------------\nTeste de normalidade dos residuos (Shapiro-Wilk)\nvalor-p:  0.6858194 \nDe acordo com o teste de Shapiro-Wilk a 5% de significancia, os residuos podem ser considerados normais.\n------------------------------------------------------------------------\n\nContraste do tratamento adicional com o fatorial\n------------------------------------------------------------------------\nDe acordo com o teste F, as medias dos dois grupos sao estatisticamente iguais.\n            Medias\nAdicional 44.97452\nFatorial  45.66750\n------------------------------------------------------------------------\n\nInteracao nao significativa: analisando os efeitos simples\n------------------------------------------------------------------------\nFungicidas\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n       Niveis   Medias\n1         FOX 45.60122\n2 PRIORI XTRA 45.73378\n------------------------------------------------------------------------\nEstádios\nDe acordo com o teste F, as medias desse fator sao estatisticamente iguais.\n------------------------------------------------------------------------\n      Niveis   Medias\n1      V6/V8 45.04767\n2 V6/V8 + VT 46.31132\n3         VT 45.64350\n------------------------------------------------------------------------\n```\n\n\n:::\n:::\n\n\nSobre a variável produtividade, não houve diferença significativa para os fatores, para a interação e nem para o fatorial versus tratamento adicional. De maneira geral, não existe ganhos em produtividade quando se adota os tratamentos. A análise pode ser finalizada aqui para esta variável. Entretando para visualizar isso graficamente vamos realizar o teste de Dunnett.\n\n### Teste de Dunnett\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprodutividade2 <- produtividade |> \n  mutate(Fator1 = ifelse(is.na(Fator1), 'TESTEMUNHA', Fator1 )) |> \n  unite(col = treat, Fator1, Fator2, sep = ' ', na.rm = TRUE)\n\ndunnett(trat = produtividade2$treat, resp = produtividade2$productivity, control = 'TESTEMUNHA', model = 'DBC', block = produtividade2$block)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                                        Estimate     IC-lwr    IC-upr t value\nTESTEMUNHA  -  FOX V6/V8              -0.7009225 -10.290613  8.888768 -0.2068\nTESTEMUNHA  -  FOX V6/V8 + VT          1.4375000  -8.152190 11.027190  0.4241\nTESTEMUNHA  -  FOX VT                  1.1435200  -8.446170 10.733210  0.3374\nTESTEMUNHA  -  PRIORI XTRA V6/V8       0.8472225  -8.742468 10.436913  0.2500\nTESTEMUNHA  -  PRIORI XTRA V6/V8 + VT  1.2361125  -8.353578 10.825803  0.3647\nTESTEMUNHA  -  PRIORI XTRA VT          0.1944475  -9.395243  9.784138  0.0574\n                                      p-value sig\nTESTEMUNHA  -  FOX V6/V8               0.9999  ns\nTESTEMUNHA  -  FOX V6/V8 + VT          0.9958  ns\nTESTEMUNHA  -  FOX VT                  0.9988  ns\nTESTEMUNHA  -  PRIORI XTRA V6/V8       0.9998  ns\nTESTEMUNHA  -  PRIORI XTRA V6/V8 + VT  0.9981  ns\nTESTEMUNHA  -  PRIORI XTRA VT          1.0000  ns\n```\n\n\n:::\n\n::: {.cell-output-display}\n![](Alternativa-2_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nComo já era sabido. Não há diferença da combinação dos níveis dos dois fatores versus a testemunha.\n",
    "supporting": [
      "Alternativa-2_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}