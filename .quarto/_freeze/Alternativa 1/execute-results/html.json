{
  "hash": "52f53d5dab17ab3159a73ef083870204",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Abordagem como um simples DBC\"\nauthor: \"Lucas R. Gava, Iago Vieira\"\nformat: html\neditor: visual\n---\n\n\n# Pacotes\n\nPacotes requeridos no decorrer do código.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(gsheet) # importação dos dados\nlibrary(tidyverse) # manipulação dos dados\nlibrary(ggthemes) # Temas gráficos\nlibrary(epifitter) # utilizar a função AUDPC()\nlibrary(performance) # este e demais pacotes destinados a análise \nlibrary(ExpDes.pt) \nlibrary(emmeans)\nlibrary(multcomp)\n```\n:::\n\n\n# Importando o banco de dados\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados <- gsheet2tbl('https://docs.google.com/spreadsheets/d/18JYhRvnwob5L0kAOor9o22Y_AwLkD7XU/edit?gid=173826027#gid=173826027')\n```\n:::\n\n\n# Ajustando os dados\n\nAntes de seguir com a análise dos dados, vamos criar uma nova variável resposta a partir da severidade das folhas 1, 2 e 3 das 3 plantas avaliadas. Essa nova variável será denominada severidade média.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados <- dados |> \n  mutate(sev.med = rowMeans(across(starts_with('sev_f')))) |> \n  dplyr::select(- starts_with('sev_f')) |> \n  group_by(treat, block, assessment) |> \n  summarise(sev_med = mean(sev.med))\n\ndados$sev_med <- round(dados$sev_med, 2)\n```\n:::\n\n\n# Gráfico de dispersão\n\nObservando a amplitude dos dados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot1 <- dados |> \n  ggplot(aes(x = treat, y = sev_med, color = treat)) + \n  geom_jitter(width = 0.2, size = 2.5, alpha = 0.7) +\n  labs(x = ' ', y = 'Severidade (%)', color = ' ') +\n  theme_classic() +\n  theme(axis.text.x = element_blank(), text = element_text(size = 15)) + \n  ylim(0, 100) +\n  geom_hline(yintercept = max(dados$sev_med), linetype = 3) +\n  annotate(geom = 'text', y = 15, x = 4, label = '12%')\n\nplot1\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n# Visualizando curvas de progresso\n\nComo nossos dados foram coletados em 4 momentos diferentes, podemos criar um gráfico de pontos, em que, o eixo x receberá os momentos de avaliação e o eixo y a severidade média. As curvas geradas também são chamadas de curvas de progresso, que representa o progresso da epidemia no tempo.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot2 <- dados |> \n  group_by(treat, assessment) |> \n  summarise(med = mean(sev_med)) |> \n  ggplot(aes(x = assessment, y = med, color = treat)) +\n  geom_point() + \n  geom_line(size = 1) +\n  theme(text = element_text(size = 15)) +\n  theme_classic() +\n  labs(x = 'Avaliações', y = 'Severidade média (%)', color = 'Tratamentos')\n\n  plot2\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nVisualizando as mesmas curvas em gráficos separados.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndados |> \n  group_by(treat, assessment) |> \n  summarise(med = mean(sev_med)) |> \n  ggplot(aes(x = assessment, y = med)) +\n  geom_jitter(data = dados, aes(y = sev_med), color = 'gray', alpha = 0.7, width = 0.1) +\n  geom_line(size = 0.5) +\n  geom_point(color = 'red') +\n  theme_clean() +\n  theme(text = element_text(size = 15), axis.title = element_text(size = 15)) +\n  facet_wrap(~treat) +\n  labs(x = 'Avaliações', y = 'Severidade média (%)', color = 'Tratamentos')\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n# Variáveis respostas\n\nAs variáveis respostas que serão analizadas aqui são a AACPD, Y máx e Produtividade (ton/ha).\n\n## AACPD\n\nCalculando AACPD.\n\n\n::: {.cell}\n\n```{.r .cell-code}\naacpd <- dados |> \n  group_by(treat, block) |> \n  summarise(aacpd = AUDPC(assessment, sev_med))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot3 <- aacpd |> \n  group_by(treat) |> \n  summarise(med = mean(aacpd)) |> \n  ggplot(aes(x = treat, y = med)) +\n  geom_col(fill = 'lightblue') +\n  theme_classic() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1), text = element_text(size = 15)) +\n  labs(x = ' ', y = \"AACPD\")\nplot3\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Y máx\n\nApenas vizualizando os gráficos anteriores, percebe-se que as epidemias se assemelham muito a um modelo exponencial. Isso facilita para a seleção do valor onde a intensidade da doença é máxima. No nosso caso, os valores de Y máx correspondem aos dados de severidade coletados na 4° avaliação. Portanto, basta filtrar essas linhas:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ny.max <- dados |> \n  filter(assessment == 4) |> \n  dplyr::select(-assessment)\n```\n:::\n\n\n## Produtividade\n\nImportando dados de produtividade.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprod <- gsheet2tbl('https://docs.google.com/spreadsheets/d/18JYhRvnwob5L0kAOor9o22Y_AwLkD7XU/edit?gid=1793405925#gid=1793405925')\n\nprod <- prod |> \n  dplyr::select(treat, block, productivity)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot4 <-  prod |> \n  group_by(treat) |> \n  summarise(prod = mean(productivity)) |> \n  ggplot(aes(treat, prod)) +\n  geom_col(fill = 'lightblue') +\n  theme_classic() +\n  theme(axis.text.x = element_text(angle = 45, hjust = 1), text = element_text(size = 15)) +\n  labs(x = ' ', y = \"Produtividade (ton/ha)\") +\n  ylim(0, 60)\n\nplot4\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n# Análise estatística\n\n## Variável AACPD\n\n### Testando as premissas\n\nAntes de seguir com a análise paramétrica, é preciso testar as premissas de homogeneidade de variâncias e normalidade dos resíduos. As funções `check_heteroscedasticity()` e `check_normality()` do pacote **Performance**, são utilizadas para verificar isso. De modo geral, a hipótese de nulidade das premissas é que as variâncias são homogêneas e os resíduos normais. Nesse caso, esperamos que o resultado do teste **não** seja significativo, ou seja, p-valor \\> 0,05. Após rodar o código temos como resultado p-valores \\> 0,05, indicando a posiibilidade de continuar com a análise paramétrica.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(aacpd ~ treat + block, aacpd)\n\ncheck_heteroscedasticity(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.336).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.334).\n```\n\n\n:::\n:::\n\n\n### ANOVA\n\nA ANOVA indicou que existe pelo menos um par de tratamentos que se diferem entre si pelo teste F ao nível de 5% de probabilidade. Seguimos agora para o teste de comparações múltiplas para distinguir quais são os tratamentos que se diferem.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: aacpd\n          Df Sum Sq Mean Sq F value    Pr(>F)    \ntreat      6 65.778 10.9629  8.0441 0.0001657 ***\nblock      1  4.281  4.2805  3.1408 0.0915890 .  \nResiduals 20 27.257  1.3629                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### Teste de Tukey\n\nO teste de Tukey é um teste de comparações múltiplas muito utilizado em experimentos agrícolas. Ele realiza as comparações múltiplas entre todos os tratamentos e distingue-os. Possibilitando identificar quais foram os melhores e piores tratamentos.\n\nComo resultado do teste abaixo, observamos a formação de 4 grupos com bantante anbiguidade (sobreposição de grupos) entre as médias dos tratamentos. Como a variável testada é referente a área abaixo da curva de progresso, queremos identificar quais foram os tratamentos que apresentaram menores valores. Pois, são estes tratamentos que apresentaram um melhor controle da epidemia. A interpretação é simples, médias dos tratamentos seguidas pela mesma letra não se diferem entre si, pelo teste de Tukey, ao nível de 5% de probabilidade. Dessa forma, verificamos que os fungicidas **PRIORI XTRA** e **FOX** aplicados nos estádios **V6/V8 + VT** e em **V6/V8** se diferiram da **TESTEMUNHA**, mas não entre si. Quando os fungicidas foram aplicados somente no estádio **VT** não teve difereça da **TESTEMUNHA**.\n\nGerando uma informação mais prática quanto ao resultado, podemos concluir que, aplicando qualquer um dos fungicidas, quando o milho ainda está no seu estádio vegetativo (**V6/V8**), é a melhor alternativa para manejo de manchas foliares na cultura. Uma vez que, realizando duas aplicações nos estádios **V6/V8** e **VT** seria desperdício de recursos e contaminação descecessária do meio ambiente.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(emmeans(m1, ~ treat), Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n treat                  emmean    SE df lower.CL upper.CL .group\n PRIORI XTRA V6/V8 + VT   1.34 0.584 20    0.122     2.56  a    \n FOX V6/V8 + VT           2.55 0.584 20    1.335     3.77  ab   \n PRIORI XTRA V6/V8        3.29 0.584 20    2.076     4.51  abc  \n FOX V6/V8                3.54 0.584 20    2.324     4.76  abc  \n PRIORI XTRA VT           4.30 0.584 20    3.082     5.52   bcd \n FOX VT                   5.31 0.584 20    4.096     6.53    cd \n TESTEMUNHA               6.24 0.584 20    5.026     7.46     d \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 7 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n## Variável Y máx\n\n### Testando premissas\n\nAgora a interpretação fica mais fácil. O resultado de p-valor \\> 0,05 indica que podemos seguir com as análises.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm2 <- lm(sev_med ~ treat + block, y.max)\n\ncheck_heteroscedasticity(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.377).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.788).\n```\n\n\n:::\n:::\n\n\n### ANOVA\n\nA ANOVA indicou que há diferença entre os tratamentos.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: sev_med\n          Df  Sum Sq Mean Sq F value   Pr(>F)   \ntreat      6 140.024 23.3373  4.9346 0.003013 **\nblock      1  25.008 25.0078  5.2878 0.032380 * \nResiduals 20  94.587  4.7294                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n### Teste de Tukey\n\nSemelhante ao observado no teste de comparações múltiplas da variável anterior, há grande anbiquidade entre os grupos formados. Com base nos resultados sobre a variável de intensidade máxima o melhor tratamento seria o **PRIORI XTRA** aplicado nos estádios **V6/V8** e **VT**.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncld(emmeans(m2, ~ treat), Letters = letters)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n treat                  emmean   SE df lower.CL upper.CL .group\n PRIORI XTRA V6/V8 + VT   2.12 1.09 20   -0.146     4.39  a    \n FOX V6/V8 + VT           4.00 1.09 20    1.737     6.27  ab   \n FOX V6/V8                4.21 1.09 20    1.944     6.48  abc  \n PRIORI XTRA V6/V8        5.37 1.09 20    3.099     7.64  abc  \n PRIORI XTRA VT           6.86 1.09 20    4.587     9.12  abc  \n FOX VT                   7.84 1.09 20    5.569    10.11   bc  \n TESTEMUNHA               9.04 1.09 20    6.769    11.31    c  \n\nConfidence level used: 0.95 \nP value adjustment: tukey method for comparing a family of 7 estimates \nsignificance level used: alpha = 0.05 \nNOTE: If two or more means share the same grouping symbol,\n      then we cannot show them to be different.\n      But we also did not show them to be the same. \n```\n\n\n:::\n:::\n\n\n## Variável de PRODUTIVIDADE\n\n### Testando premissas\n\nPremissas atendidas!\n\nSeguimos para a ANOVA.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm3 <- lm(productivity ~ treat + block, prod)\n\ncheck_heteroscedasticity(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: Error variance appears to be homoscedastic (p = 0.516).\n```\n\n\n:::\n\n```{.r .cell-code}\ncheck_normality(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nOK: residuals appear as normally distributed (p = 0.197).\n```\n\n\n:::\n:::\n\n\n### ANOVA\n\nO p-valor do teste F foi maior que 0,05. Logo, conclui-se que não existe diferença entre os tratamentos quando se analisa a varial **PRODUTIVIDADE**.\n\nDe maneira prática, podemos dizer que se o objetivo do ensaio foi controlar manchas foliares na cultura do milho e não houve diferença significativa entre as médias de produtividade, não realizar a aplicação de fungicida seria a melhor opção.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: productivity\n          Df Sum Sq Mean Sq F value Pr(>F)\ntreat      6  14.72  2.4528  0.0980 0.9958\nblock      1   8.35  8.3510  0.3337 0.5699\nResiduals 20 500.52 25.0260               \n```\n\n\n:::\n:::\n\n\n# Gráficos\n\nTratamentos que se diferiram da testemunha.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot2 <- plot2 + \n  annotate(geom = 'text', x = 4, y = 1.72, label = '*', size = 7) +\n  annotate(geom = 'text', x = 4, y = 3.6, label = '*', size = 7)\n\nplot2\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot3 <- plot3 +\n  annotate(geom = 'text', x = 5, y = 1.7, label = '*', size = 7) +\n  annotate(geom = 'text', x = 2, y = 3, label = '*', size = 7) +\n  annotate(geom = 'text', x = 4, y = 3.8, label = '*', size = 7) +\n  annotate(geom = 'text', x = 1, y = 4, label = '*', size = 7)\n\nplot3\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot4 <- plot4 + \n  annotate(geom = 'text', x = 7, y = 49, label = 'ns', size = 5)\n\nplot4\n```\n\n::: {.cell-output-display}\n![](Alternativa-1_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Alternativa-1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}